os: osx
cache:
  directories:
    - bower_components
    - node_modules
    - app/node_modules
    - cache
before_install:
    - travis/brew_restore.sh
    - brew update
    - brew install wine makensis
    - brew cleanup
    - brew cask install google-chrome
    - npm install grunt-cli -g
    - npm install
    - travis/brew_cache.sh
install:
    - grunt dev
script:
    - npm test
before_deploy:
    - travis/build.sh
deploy:
  provider: releases
  api_key: $GITHUB_TOKEN
  skip_cleanup: true
  file:
    - release/chrome/chrome-app.zip
    - release/electron/darwin-x64.zip
    - release/electron/win32-ia32.zip
    - release/electron/win32-x64.zip
  on:
    all_branches: true
    tags: true

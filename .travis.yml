language: objective-c
cache:
  directories:
    - bower_components
    - node_modules
before_install:
    - npm install grunt-cli -g
    - npm install
install:
    - grunt dev
script:
    - Xvfb :1337 & export DISPLAY=:1337 & npm test
before_deploy:
    - brew update
    - brew install wine makensis
    - wine --version
    - ./build.sh
deploy:
  provider: releases
  api_key: $GITHUB_TOKEN
  skip_cleanup: true
  file:
    - release/chrome/chrome-app.zip
    - release/electron/darwin-x64.zip
    - release/electron/win32-ia32.zip
    - release/electron/win32-x64.zip
  on:
    all_branches: true
    tags: true
